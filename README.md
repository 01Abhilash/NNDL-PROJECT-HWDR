âœ¨ Handwritten Digit Recognition using Deep Learning
A Complete End-to-End Project by Abhilash K R (USN: 3BR22CA001)
Department of CSE (AI), BITM Ballari
ğŸ“˜ Project Overview

This project implements a high-accuracy Convolutional Neural Network (CNN) to recognize handwritten digits (0â€“9). It uses the MNIST PNG Dataset, trains a robust CNN model for 10 full epochs, evaluates the model with industry-standard metrics, and provides a Pygame-based interactive application for real-time digit recognition.

The project showcases end-to-end AI engineering, including dataset preprocessing, model development, evaluation, and user interface deployment.

ğŸ§  Key Features
ğŸ”¹ Deep Learning Model (CNN)

Trained on MNIST PNG dataset

Uses advanced layers: BatchNorm, Dropout, Adam Optimizer

Achieves high accuracy (98â€“99%)

ğŸ”¹ Interactive Pygame Application

Real-time drawing board

Image upload & recognition

Five-screen flow (Start â†’ Mode â†’ Draw/Upload â†’ Detection â†’ Message)

Custom keyboard shortcuts

Save screenshots for documentation

ğŸ”¹ Strong Evaluation Pipeline

Training & testing confusion matrices (side-by-side)

Precisionâ€“Recall Curves for all digits

Accuracy, Precision, Recall, F1-Score

Full classification report

ğŸ“‚ Project Structure
NNDL Project/
â”‚â”€â”€ bestmodel_png.h5                 # Best trained CNN model  
â”‚â”€â”€ digit_app_final_corrected.py     # Pygame application with 5-screen UI  
â”‚â”€â”€ evaluation.py                    # Full evaluation script (CM + PR Curves)  
â”‚â”€â”€ training.ipynb                   # 10-epoch CNN training notebook  
â”‚â”€â”€ saved_images/                    # Auto-saved annotated images  
â”‚â”€â”€ debug_outputs/                   # Saved outputs for debugging  
â”‚â”€â”€ README.md                        # Documentation (this file)  
â”‚â”€â”€ archive/mnist_png/               # Dataset  
â”‚     â”œâ”€â”€ train/
â”‚     â”‚    â”œâ”€â”€ 0/  
â”‚     â”‚    â”œâ”€â”€ 1/  
â”‚     â”‚    â””â”€â”€ â€¦  
â”‚     â””â”€â”€ test/
â”‚          â”œâ”€â”€ 0/  
â”‚          â”œâ”€â”€ 1/  
â”‚          â””â”€â”€ â€¦  

ğŸ“Š Dataset Details
âœ” Dataset Used:

MNIST-PNG Dataset
ğŸ“¥ Link: https://www.kaggle.com/datasets/alexanderyyy/mnist-png/data

âœ” Total Samples:
Split	Samples	Description
Training	60,000 images	in train/0 - train/9
Testing	10,000 images	in test/0 - test/9
Total	70,000 images	PNG format
âœ” Image Details

Size â†’ 28Ã—28 pixels

Color â†’ Grayscale

Each folder corresponds to a digit label

ğŸ‹ï¸ Training Summary (10 Epochs)
âœ” Training Code Features

ImageDataGenerator (augmentation)

Batch size = 128

Learning rate = 0.001

Dropouts: 25%, 30%, 40%

ModelCheckpoint to save best accuracy

ReduceLROnPlateau for LR scheduling

Full 10 epochs (no early stopping)

âœ” Final Test Accuracy

â‰ˆ 98â€“99%

ğŸ§  CNN Model Architecture
Input (28x28x1)
â”‚
â”œâ”€â”€ Conv2D (32 filters, 3Ã—3) + BatchNorm
â”œâ”€â”€ Conv2D (32 filters, 3Ã—3) + BatchNorm
â”œâ”€â”€ MaxPooling2D + Dropout(0.25)
â”‚
â”œâ”€â”€ Conv2D (64 filters) + BatchNorm
â”œâ”€â”€ Conv2D (64 filters) + BatchNorm
â”œâ”€â”€ MaxPooling2D + Dropout(0.30)
â”‚
â”œâ”€â”€ Flatten
â”œâ”€â”€ Dense (128 units, relu) + BatchNorm + Dropout(0.40)
â”‚
â””â”€â”€ Dense (10 units, Softmax)

âœ” Activation Functions

Hidden layers â†’ ReLU

Output layer â†’ Softmax

ğŸ“ˆ Model Evaluation
âœ” Metrics Calculated

Accuracy

Precision

Recall

F1-score

Training Confusion Matrix

Testing Confusion Matrix

Precisionâ€“Recall Curve

âœ” Output Images Generated by evaluation.py

confusion_matrices.png
(Training + Testing confusion matrices side-by-side)

precision_recall_curve.png
(10 separate PR curves)

ğŸ¨ Pygame Application (5-Screen UI)
âœ” Screen Flow

Start Screen

"Digit Recognition"

ENTER â†’ Continue

Shortcuts displayed

Mode Selection

Draw on Blackboard

Upload Image

Shortcuts + Save screen support

Drawing Canvas

Thick white brush

CNN prediction appears after mouse release

Bounding box + confidence %

Keys:

C â†’ Clear

S â†’ Save screen

Backspace â†’ Back

Q â†’ Quit

Uploaded Image Detection

Automatically detects digits in uploaded PNG/JPG

Draws bounding boxes

Shows Digit + Confidence

ENTER â†’ Message screen

S â†’ Save annotated screen

Message Screen

"Upload more images"

ENTER â†’ Re-upload

BACKSPACE â†’ Back

Q â†’ Quit

ğŸ–¥ï¸ How to Run the Project
1ï¸âƒ£ Install Requirements
pip install tensorflow keras numpy matplotlib pygame opencv-python scikit-learn

2ï¸âƒ£ Train the Model

Run the training notebook:

training.ipynb

3ï¸âƒ£ Evaluate the Model
python evaluation.py


Outputs generated:

confusion_matrices.png

precision_recall_curve.png

4ï¸âƒ£ Run the Application
python digit_app_final_corrected.py

ğŸ‘¨â€ğŸ’» Author

Abhilash K R
USN: 3BR22CA001
CSE (AI),
Ballari Institute of Technology & Management
